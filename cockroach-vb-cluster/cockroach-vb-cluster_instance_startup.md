---
title: CockroachDB Instance Startup
tags: 
keywords: CockroachDB, Install, Setup, Guide, Tutorial
last_updated: 
summary: "How to startup, shutdown a CockroachDB cluster."
---

If you are re-creating the cluster, execute a `vagrant destroy --force` in the `cockroach-vb-cluster` directory.

{{site.data.alerts.tip}}
You can quickly open a command prompt in the desired directory by holding down shift key and right-clicking the folder name in the Windows File Manager, then choose "Open command window here".
{{site.data.alerts.end}}

You can start a CockroachDB database cluster in one of two security modes.

* Insecure
* Secure

Insecure uses the http protocol, Secure uses the https protocol and requires the SSL certificates.

It's recommedned that you use the secure method as it's the one you should use for anything real.
For now, you will have to connect to each cluster node to start it's database instance. Coming soon is a script executed from the client machine that will start selected instances.


## Insecure Startup

Commands are executed from the `$HOME` directory of the roachdb user on each node. 


### First Database Instance

The first database instance does not have to be started on the first cluster node (nodeA), we are doing it to keep things simple.

On nodeA, as the roachdb user:


```Shell
[roachdb@nodeA ~]$ cockroach start --insecure --host=nodeA
build:     beta-20160407 @ 2016/04/07 15:24:20 (go1.6)
admin:     http://nodeA:8080
sql:       postgresql://root@nodeA:26257?sslmode=disable
logs:      cockroach-data/logs
store[0]:  path=cockroach-data
```

### Additional Instances

On node B, as the roachdb user:

```Shell
[roachdb@nodeB ~]$ cockroach start --insecure --host=nodeB --join=nodeA:26257
build:     beta-20160407 @ 2016/04/07 15:24:20 (go1.6)
admin:     http://nodeB:8080
sql:       postgresql://root@nodeB:26257?sslmode=disable
logs:      cockroach-data/logs
store[0]:  path=cockroach-data
```

And nodeC:

```Shell
[roachdb@nodeC ~]$ cockroach start --insecure --host=nodeC --join=nodeA:26257
build:     beta-20160407 @ 2016/04/07 15:24:20 (go1.6)
admin:     http://nodeC:8080
sql:       postgresql://root@nodeC:26257?sslmode=disable
logs:      cockroach-data/logs
store[0]:  path=cockroach-data
```


## Secure Startup

### Security Certificates

A set of SSL certificates are required to operate the cluster in Secure mode. These certificates are currently generated by the `cockroach` executable using the `cert` argument.

The certificates have been created by the `node_provision.bash` script and placed in the `$HOME/certs` directory of the roachdb user.

>Description of the certs coming soon.

```Shell
[roachdb@nodeA ~]$ ls -l certs
total 24
-rw-r--r--. 1 roachdb roachdb 1111 Apr 17 21:55 ca.cert
-rw-------. 1 roachdb roachdb 1679 Apr 17 21:55 ca.key
-rw-r--r--. 1 roachdb roachdb 1151 Apr 17 22:49 nodeA.cert
-rw-------. 1 roachdb roachdb 1679 Apr 17 22:49 nodeA.key
-rw-r--r--. 1 roachdb roachdb 1103 Apr 17 21:57 root.cert
-rw-------. 1 roachdb roachdb 1679 Apr 17 21:57 root.key
[roachdb@nodeA ~]$
```

If this was a "real" cluster, you wouldn't have the `ca.key` file on any cluster node.


### First Database Instance

You can either issue commands by logging onto each node or you can use the vagrant ssh command from the host.

From the host machine, in the `cockroach-vb-cluster` directory, at the command prompt, execute the `vagrant ssh nodeA` to logon to nodeA and start the first cluster instance. We are using nodeA but it can be started on any node.

`cockroach start --host=nodeA --ca-cert=certs/ca.cert --cert=certs/nodeA.cert --key=certs/nodeA.key`


```Shell
[roachdb@nodeA ~]$ cockroach start --host=nodeA --ca-cert=certs/ca.cert --cert=certs/nodeA.cert --key=certs/nodeA.key
build:     beta-20160414 @ 2016/04/14 15:15:52 (go1.6)
admin:     https://nodeA:8080
sql:       postgresql://root@nodeA:26257?sslcert=%2Fhome%2Froachdb%2Fcerts%2FnodeA.cert&sslkey=%2Fhome%2Froachdb%2Fcerts%2FnodeA.key&sslmode=verify-full&sslrootcert=%2Fhome%2Froachdb%2Fcerts%2Fca.cert
logs:      cockroach-data/logs
store[0]:  path=cockroach-data
```

### Additional Instances

Each additional instance started has to join the first instance to become a member of the cluster.

`cockroach start --host=nodeB --join=nodeA:26257 --ca-cert=certs/ca.cert --cert=certs/nodeB.cert --key=certs/nodeB.key`

```Shell
[roachdb@nodeB ~]$ cockroach start --host=nodeB --join=nodeA:26257 --ca-cert=certs/ca.cert --cert=certs/nodeB.cert --key=certs/nodeB.key
build:     beta-20160414 @ 2016/04/14 15:15:52 (go1.6)
admin:     https://nodeB:8080
sql:       postgresql://root@nodeB:26257?sslcert=%2Fhome%2Froachdb%2Fcerts%2FnodeB.cert&sslkey=%2Fhome%2Froachdb%2Fcerts%2FnodeB.key&sslmode=verify-full&sslrootcert=%2Fhome%2Froachdb%2Fcerts%2Fca.cert
logs:      cockroach-data/logs
store[0]:  path=cockroach-data
```

>Need a way to automate the startup of an instance on each node. Maybe systemd configuration?


## Shutdown

Coming soon.

`cockroach quit` 

```Shell
[roachdb@nodeC ~]$ cockroach quit --insecure
node drained and shutdown: ok

[roachdb@nodeC ~]$ initiating graceful shutdown of server
server drained and shutdown completed

[1]+  Done                    cockroach start --insecure --join=nodeA:26257
[roachdb@nodeC ~]$
```


## Logging

The location of the log files are specified in the instance startup messages. By default, the logs are located in the `cockroach-data/logs` directory. There are 3 logs.... also available in the UI.


## What's Next?

We will use the built-in client software to [connect to the database](cockroach-vb-cluster_connect_to_the_database).

